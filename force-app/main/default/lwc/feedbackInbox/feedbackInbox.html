<template>
    <div class="feedback-inbox">
        <div class="inbox-card">
            
            <!-- Header -->
            <div class="card-header">
                <div class="header-content">
                    <lightning-icon icon-name="utility:note" size="small" class="header-icon"></lightning-icon>
                    <h3 class="header-title">Agent Notes</h3>
                </div>
                <div class="response-count">
                    <span class="count-badge">{responseCount}</span>
                </div>
            </div>

            <template if:true={showInbox}>
                <!-- Show which feedback is selected -->
                <div class="selected-feedback">
                    <lightning-icon icon-name="utility:record" size="x-small" class="record-icon"></lightning-icon>
                    <span class="selected-text">Agent notes for: <strong>{selectedFeedbackName}</strong></span>
                </div>

                <!-- Responses List -->
                <div class="responses-container">
                    <template if:true={hasResponses}>
                        <template for:each={responses} for:item="response">
                            <div key={response.id} class="response-item">
                                <div class="response-header">
                                    <div class="response-meta">
                                        <lightning-icon icon-name="utility:user" size="x-small" class="user-icon"></lightning-icon>
                                        <span class="created-by">{response.createdBy}</span>
                                        <span class="agent-badge">AGENT</span>
                                    </div>
                                    <div class="response-date">{response.formattedDate}</div>
                                </div>
                                <div class="response-content">
                                    <div class="note-label">Response logged:</div>
                                    <p class="response-text">{response.message}</p>
                                </div>
                            </div>
                        </template>
                    </template>

                    <!-- No Responses State -->
                    <template if:false={hasResponses}>
                        <div class="empty-state">
                            <lightning-icon icon-name="utility:notes" size="large" class="empty-icon"></lightning-icon>
                            <h4 class="empty-title">No Agent Notes Yet</h4>
                            <p class="empty-description">Agent responses and notes for this feedback will appear here</p>
                        </div>
                    </template>

                    <!-- Error State -->
                    <template if:true={error}>
                        <div class="error-state">
                            <lightning-icon icon-name="utility:error" size="medium" class="error-icon"></lightning-icon>
                            <p class="error-message">Error loading agent notes: {error.body.message}</p>
                        </div>
                    </template>
                </div>
            </template>

            <!-- No Feedback Selected State -->
            <template if:false={showInbox}>
                <div class="empty-state selection-state">
                    <lightning-icon icon-name="utility:choice" size="large" class="empty-icon"></lightning-icon>
                    <h4 class="empty-title">Select Feedback</h4>
                    <p class="empty-description">Choose a feedback record in Status Manager to view agent notes and responses</p>
                </div>
            </template>

        </div>
    </div>
</template> 